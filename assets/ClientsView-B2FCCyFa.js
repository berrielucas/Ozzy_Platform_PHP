import{a as j,d as x,e as g,r as s,b as y,f as D,c as C,w as o,g as V,h as e,i as d,j as b,o as I,k as L,t as O,m as G,l as A}from"./index-CyU7WMZp.js";import{F as H}from"./Filter-9vLo2J3n.js";import{_ as K,a as Q}from"./ToggleMenu-Ge7VitD_.js";const R=b("h4",{class:"ml-1 mb-2"},"Dados Pessoais",-1),W=b("h4",{class:"mt-1 ml-1 mb-2"},"Endereço",-1),T={__name:"NewClient",props:{edit:{type:Boolean,required:!1},id:{type:Number,required:!1}},setup(M){const n=j(),_=M,p=x(!1),f=_.edit?JSON.stringify(n.clientes.filter(v=>v.idCliente===_.id)[0]):JSON.stringify({nome:null,telefone1:"",telefone2:"",email:null,senha:null,logradouro:null,cep:"",numero:null,cidade:null,estado:"",cpf:""}),t=x(JSON.parse(f)),h=g(()=>{t.value.cpf=n.formatCPF(t.value.cpf)}),c=g(async()=>{const v=await n.formatCEP(t.value.cep);t.value.cep=v.cep,v.dados!==null&&(t.value.estado=v.dados.state,t.value.cidade=v.dados.city,t.value.logradouro=v.dados.street)}),w=g(()=>{t.value.telefone1=n.formatPhone(t.value.telefone1)}),E=g(()=>{t.value.telefone2=n.formatPhone(t.value.telefone2)}),N=g(()=>{t.value.estado=n.formatEstado(t.value.estado)});function u(){_.edit?n.atualizarCliente(t.value):n.cadastrarCliente(t.value),p.value=!1,t.value=JSON.parse(f)}return(v,l)=>{const k=s("v-list-item"),U=s("v-btn"),r=s("v-col"),m=s("v-text-field"),$=s("v-row"),P=s("v-card-text"),z=s("v-divider"),S=s("v-spacer"),B=s("v-card-actions"),q=s("v-card"),F=s("v-dialog");return y(),D("div",null,[_.edit?(y(),C(k,{key:0,onClick:l[0]||(l[0]=a=>p.value=!0)},{default:o(()=>[V("Acessar")]),_:1})):(y(),C(U,{key:1,onClick:l[1]||(l[1]=a=>p.value=!0),class:"text-none ml-4",variant:"elevated",text:"Adicionar",style:{"background-color":"var(--primary-color)",color:"white","border-radius":"10px","font-size":"medium"}})),e(F,{modelValue:p.value,"onUpdate:modelValue":l[19]||(l[19]=a=>p.value=a),width:"auto",persistent:""},{default:o(()=>[e(q,{loading:d(n).loadCEP,disabled:d(n).loadCEP,"prepend-icon":"mdi-account",title:_.edit?"Cliente":"Novo Cliente","max-width":"850"},{default:o(()=>[e(P,{class:"px-4 py-3"},{default:o(()=>[e($,{dense:""},{default:o(()=>[e(r,{cols:"12"},{default:o(()=>[R]),_:1}),e(r,{cols:"12",md:"6",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.nome,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.nome=a),label:"Nome *",required:""},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"6",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.email,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.email=a),label:"Email *",type:"email"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.cpf,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.cpf=a),update:h.value,"onUpdate:update":l[5]||(l[5]=a=>h.value=a),maxlength:"14",label:"CPF"},null,8,["modelValue","update"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.telefone1,"onUpdate:modelValue":l[6]||(l[6]=a=>t.value.telefone1=a),update:w.value,"onUpdate:update":l[7]||(l[7]=a=>w.value=a),maxlength:"15",label:"Celular *",required:""},null,8,["modelValue","update"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.telefone2,"onUpdate:modelValue":l[8]||(l[8]=a=>t.value.telefone2=a),update:E.value,"onUpdate:update":l[9]||(l[9]=a=>E.value=a),maxlength:"15",label:"Telefone"},null,8,["modelValue","update"])]),_:1}),e(r,{cols:"12"},{default:o(()=>[W]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.cep,"onUpdate:modelValue":l[10]||(l[10]=a=>t.value.cep=a),update:c.value,"onUpdate:update":l[11]||(l[11]=a=>c.value=a),maxlength:"9",label:"CEP",required:""},null,8,["modelValue","update"])]),_:1}),e(r,{cols:"12",md:"8",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.logradouro,"onUpdate:modelValue":l[12]||(l[12]=a=>t.value.logradouro=a),label:"Logradouro",required:""},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.numero,"onUpdate:modelValue":l[13]||(l[13]=a=>t.value.numero=a),label:"Numero"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.estado,"onUpdate:modelValue":l[14]||(l[14]=a=>t.value.estado=a),update:N.value,"onUpdate:update":l[15]||(l[15]=a=>N.value=a),maxlength:"2",label:"Estado"},null,8,["modelValue","update"])]),_:1}),e(r,{cols:"12",md:"4",sm:"6"},{default:o(()=>[e(m,{modelValue:t.value.cidade,"onUpdate:modelValue":l[16]||(l[16]=a=>t.value.cidade=a),label:"Cidade"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(z),e(B,{class:"px-4"},{default:o(()=>[e(S),e(U,{class:"text-none",text:"Cancelar",variant:"plain",onClick:l[17]||(l[17]=a=>{p.value=!1,t.value=JSON.parse(d(f))})}),e(U,{onClick:l[18]||(l[18]=a=>u()),class:"text-none",color:"var(--primary-color)",text:"Salvar",variant:"tonal"})]),_:1})]),_:1},8,["loading","disabled","title"])]),_:1},8,["modelValue"])])}}},X={style:{display:"flex","font-weight":"500","font-size":"20px"}},Y=b("div",{class:"pt-10 py-4"},[b("h3",{class:"font-weight-medium opacity-80"},"Nenhum cliente encontrado na base.")],-1),Z={class:"pb-3 pt-4"},ae={__name:"ClientsView",setup(M){const n=j();I(()=>{n.listarClientes()});const _=x(""),p=x(1),f=x(10),t=g(()=>Math.ceil(n.clientes.length/f.value)),h=L({headers:[{align:"start",key:"nome",title:"Nome"},{title:"Email",key:"email"},{title:"Celular",key:"telefone1"},{title:"Ações",key:"action",align:"end",sortable:!1}]}),c=x([]),w=g(()=>c.value.length>0),E=window.location.origin;return(N,u)=>{const v=s("v-chip"),l=s("v-app-bar"),k=s("v-btn"),U=s("v-navigation-drawer"),r=s("v-skeleton-loader"),m=s("v-tooltip"),$=s("v-progress-circular"),P=s("v-list-item"),z=s("v-list"),S=s("v-menu"),B=s("v-pagination"),q=s("v-data-table"),F=s("v-card"),a=s("v-main");return y(),C(a,{style:{padding:"0",margin:"0"}},{default:o(()=>[e(l,{class:"py-1 px-3","scroll-behavior":"elevate",density:"compact"},{prepend:o(()=>[e(K),b("h3",X,O(N.$route.meta.titulo),1)]),append:o(()=>[e(H,{onItemsPerPage:u[0]||(u[0]=i=>f.value=i)}),e(Q,{class:"ml-4",style:{"max-width":"300px"},onValor:u[1]||(u[1]=i=>_.value=i)}),e(T)]),default:o(()=>[e(v,{class:"px-5 py-4",color:"var(--primary-color)",style:{"font-weight":"600","font-size":"medium"}},{default:o(()=>[V(O(d(n).clientes.length<=0?"Nenhum cliente":d(n).clientes.length==1?`${d(n).clientes.length} Cliente`:`${d(n).clientes.length} Clientes`),1)]),_:1})]),_:1}),e(U,{class:"pr-3 pl-2",modelValue:w.value,"onUpdate:modelValue":u[2]||(u[2]=i=>w.value=i),location:"right"},{default:o(()=>[e(v,{class:"px-5 py-5 mb-1 mt-3 w-100",color:"var(--primary-color)",style:{"font-weight":"600","border-radius":"10px","font-size":"medium","justify-content":"center"}},{default:o(()=>[V(O(c.value.length>1?`${c.value.length} selecionados`:`${c.value.length} selecionado`),1)]),_:1}),e(k,{class:"text-none w-100 mt-3",variant:"elevated",color:"var(--primary-color)","prepend-icon":"mdi-email-outline",text:"Enviar email",style:{color:"white","border-radius":"10px","font-size":"medium"}}),e(k,{class:"text-none w-100 mt-3",variant:"elevated",color:"red","prepend-icon":"mdi-trash-can",text:"Excluir",style:{color:"white","border-radius":"10px","font-size":"medium"}})]),_:1},8,["modelValue"]),e(F,{class:"mx-2 my-4",elevation:"0",style:{"border-radius":"0"}},{default:o(()=>[e(q,{loading:d(n).loadClientes,disabled:d(n).loadClientes&&d(n).clientes.length>0,class:"content",modelValue:c.value,"onUpdate:modelValue":u[4]||(u[4]=i=>c.value=i),"item-value":"email",page:p.value,"onUpdate:page":u[5]||(u[5]=i=>p.value=i),headers:h.headers,items:d(n).clientes,"items-per-page":f.value,"fixed-header":"",style:{"font-size":"16px"},"show-select":!1,hover:d(n).clientes.length>0},{"no-data":o(()=>[Y]),loading:o(()=>[e(r,{type:"table-row-divider@3"})]),"item.action":o(({item:i})=>[e(S,{location:"bottom right","close-on-content-click":!1},{activator:o(({props:J})=>[e(k,G({icon:"mdi-dots-vertical"},J,{variant:"text",size:"40"}),null,16)]),default:o(()=>[e(z,{style:{"min-width":"150px"}},{default:o(()=>[e(T,{edit:!0,id:i.idCliente},null,8,["id"]),e(P,{onClick:J=>d(n).enviarEmailNewPass({email:i.email,urlBase:`${d(E)}/portal/auth/`,type:"client"})},{append:o(()=>[d(n).loadEnviarEmailNewPass?(y(),C($,{key:0,class:"ml-3",indeterminate:"",size:22,style:{color:"var(--primary-color)"}})):A("",!0)]),default:o(()=>[e(m,{left:"",activator:"parent"},{default:o(()=>[V("Enviar email de redefinição de senha")]),_:1}),V(" Alterar senha ")]),_:2},1032,["onClick"]),c.value.length===0?(y(),C(P,{key:0,onClick:J=>d(n).deletarCliente({idCliente:i.idCliente})},{default:o(()=>[V("Excluir")]),_:2},1032,["onClick"])):A("",!0)]),_:2},1024)]),_:2},1024)]),bottom:o(()=>[b("div",Z,[!d(n).loadClientes&&d(n).clientes.length>0&&d(n).clientes.length>f.value?(y(),C(B,{key:0,rounded:"",style:{"max-width":"700px","margin-inline":"auto"},modelValue:p.value,"onUpdate:modelValue":u[3]||(u[3]=i=>p.value=i),length:t.value},null,8,["modelValue","length"])):A("",!0)])]),_:1},8,["loading","disabled","modelValue","page","headers","items","items-per-page","show-select","hover"])]),_:1})]),_:1})}}};export{ae as default};
