import{a as M,d as w,e as U,r as n,b as _,f as D,c as V,w as t,g as x,h as e,i,j as g,t as T,_ as j,o as L,k as G,m as H,l as J,p as K,n as Q}from"./index-CyU7WMZp.js";import{F as R}from"./Filter-9vLo2J3n.js";import{_ as W,a as X}from"./ToggleMenu-Ge7VitD_.js";const Y={style:{display:"flex","align-items":"center"}},Z=g("h4",{class:"ml-1 mb-2"},"Dados Pessoais",-1),ee=g("h4",{class:"mt-1 ml-1 mb-2"},"Endereço",-1),O={__name:"NewUser",props:{edit:{type:Boolean,required:!1},id:{type:Number,required:!1}},setup(b){const s=M(),y=b,p=w(!1),c=y.edit?JSON.stringify(s.users.filter(v=>v.idFuncionario===y.id)[0]):JSON.stringify({nome:null,telefone1:"",telefone2:"",email:null,senha:null,logradouro:null,cep:"",numero:null,cidade:null,estado:"",cpf:"",ativo:!0,adm:!1}),o=w(JSON.parse(c)),P=U(()=>{o.value.cpf=s.formatCPF(o.value.cpf)}),C=U(async()=>{const v=await s.formatCEP(o.value.cep);o.value.cep=v.cep,v.dados!==null&&(o.value.estado=v.dados.state,o.value.cidade=v.dados.city,o.value.logradouro=v.dados.street)}),N=U(()=>{o.value.telefone1=s.formatPhone(o.value.telefone1)}),E=U(()=>{o.value.telefone2=s.formatPhone(o.value.telefone2)}),r=U(()=>{o.value.estado=s.formatEstado(o.value.estado)});function h(){y.edit?s.atualizarUsuario(o.value):s.cadastrarUsuario(o.value),p.value=!1,o.value=JSON.parse(c)}return(v,l)=>{const F=n("v-list-item"),k=n("v-btn"),S=n("v-icon"),$=n("v-switch"),u=n("v-col"),m=n("v-text-field"),z=n("v-row"),A=n("v-card-text"),q=n("v-divider"),B=n("v-spacer"),I=n("v-card-actions"),d=n("v-card"),f=n("v-dialog");return _(),D("div",null,[y.edit?(_(),V(F,{key:0,onClick:l[0]||(l[0]=a=>p.value=!0)},{default:t(()=>[x("Acessar")]),_:1})):(_(),V(k,{key:1,onClick:l[1]||(l[1]=a=>p.value=!0),class:"text-none ml-4",variant:"elevated",text:"Adicionar",style:{"background-color":"var(--primary-color)",color:"white","border-radius":"10px","font-size":"medium"}})),e(f,{modelValue:p.value,"onUpdate:modelValue":l[21]||(l[21]=a=>p.value=a),width:"auto",persistent:""},{default:t(()=>[e(d,{loading:i(s).loadCEP,disabled:i(s).loadCEP,"max-width":"850"},{title:t(()=>[g("div",Y,[e(S,{class:"mr-3",style:{display:"inline-flex"}},{default:t(()=>[x("mdi-account")]),_:1}),g("h4",null,T(y.edit?"Funcionário":"Novo Funcionário"),1),e($,{modelValue:o.value.adm,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.adm=a),class:"ml-auto",color:"var(--primary-color)",label:"Administrador",style:{display:"inline-flex"}},null,8,["modelValue"]),e($,{modelValue:o.value.ativo,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.ativo=a),class:"ml-6",color:"var(--primary-color)",label:"Ativo",style:{display:"inline-flex"}},null,8,["modelValue"])])]),default:t(()=>[e(A,{class:"px-4 pb-3"},{default:t(()=>[e(z,{dense:""},{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[Z]),_:1}),e(u,{cols:"12",md:"6",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.nome,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.nome=a),label:"Nome *",required:""},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"6",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.email,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.email=a),label:"Email *",required:""},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.cpf,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.cpf=a),update:P.value,"onUpdate:update":l[7]||(l[7]=a=>P.value=a),maxlength:"14",label:"CPF"},null,8,["modelValue","update"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.telefone1,"onUpdate:modelValue":l[8]||(l[8]=a=>o.value.telefone1=a),update:N.value,"onUpdate:update":l[9]||(l[9]=a=>N.value=a),maxlength:"15",label:"Celular *",required:""},null,8,["modelValue","update"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.telefone2,"onUpdate:modelValue":l[10]||(l[10]=a=>o.value.telefone2=a),update:E.value,"onUpdate:update":l[11]||(l[11]=a=>E.value=a),maxlength:"15",label:"Telefone"},null,8,["modelValue","update"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[ee]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.cep,"onUpdate:modelValue":l[12]||(l[12]=a=>o.value.cep=a),update:C.value,"onUpdate:update":l[13]||(l[13]=a=>C.value=a),maxlength:"9",label:"CEP",required:""},null,8,["modelValue","update"])]),_:1}),e(u,{cols:"12",md:"8",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.logradouro,"onUpdate:modelValue":l[14]||(l[14]=a=>o.value.logradouro=a),label:"Logradouro",required:""},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.numero,"onUpdate:modelValue":l[15]||(l[15]=a=>o.value.numero=a),label:"Numero"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.estado,"onUpdate:modelValue":l[16]||(l[16]=a=>o.value.estado=a),update:r.value,"onUpdate:update":l[17]||(l[17]=a=>r.value=a),maxlength:"2",label:"Estado"},null,8,["modelValue","update"])]),_:1}),e(u,{cols:"12",md:"4",sm:"6"},{default:t(()=>[e(m,{modelValue:o.value.cidade,"onUpdate:modelValue":l[18]||(l[18]=a=>o.value.cidade=a),label:"Cidade"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(q),e(I,{class:"px-4"},{default:t(()=>[e(B),e(k,{onClick:l[19]||(l[19]=a=>{p.value=!1,o.value=JSON.parse(i(c))}),class:"text-none",text:"Cancelar",variant:"plain"}),e(k,{onClick:l[20]||(l[20]=a=>h()),class:"text-none",color:"var(--primary-color)",text:"Salvar",variant:"tonal"})]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])])}}},le=b=>(K("data-v-1079656f"),b=b(),Q(),b),oe={style:{display:"flex","font-weight":"500","font-size":"20px"}},ae=le(()=>g("div",{class:"pt-10 py-4"},[g("h3",{class:"font-weight-medium opacity-80"},"Nenhum funcionário encontrado na base.")],-1)),te={class:"pb-3 pt-4"},ne={__name:"UsersView",setup(b){const s=M();L(()=>{s.listarUsuarios()});const y=w(""),p=w(1),c=w(10),o=U(()=>Math.ceil(s.users.length/c.value)),P=G({headers:[{align:"start",key:"nome",title:"Nome"},{title:"Email",key:"email"},{title:"Perfil",key:"adm"},{title:"Ativo",key:"ativo",align:"start"},{title:"Ações",key:"action",align:"end",sortable:!1}]}),C=w([]),N=window.location.origin;return(E,r)=>{const h=n("v-app-bar"),v=n("v-skeleton-loader"),l=n("v-chip"),F=n("v-switch"),k=n("v-btn"),S=n("v-tooltip"),$=n("v-progress-circular"),u=n("v-list-item"),m=n("v-list"),z=n("v-menu"),A=n("v-pagination"),q=n("v-data-table"),B=n("v-card"),I=n("v-main");return _(),V(I,{style:{padding:"0",margin:"0"}},{default:t(()=>[e(h,{class:"py-1 px-3","scroll-behavior":"elevate",density:"compact"},{prepend:t(()=>[e(W),g("h3",oe,T(E.$route.meta.titulo),1)]),append:t(()=>[e(R,{onItemsPerPage:r[0]||(r[0]=d=>c.value=d)}),e(X,{class:"ml-4",style:{"max-width":"300px"},onValor:r[1]||(r[1]=d=>y.value=d)}),e(O)]),_:1}),e(B,{class:"mx-2 my-4",elevation:"0",style:{"border-radius":"0"}},{default:t(()=>[e(q,{loading:i(s).loadUsers,disabled:i(s).loadUsers&&i(s).users.length>0,class:"content",modelValue:C.value,"onUpdate:modelValue":r[3]||(r[3]=d=>C.value=d),"item-value":"email",page:p.value,"onUpdate:page":r[4]||(r[4]=d=>p.value=d),headers:P.headers,items:i(s).users,"items-per-page":c.value,"fixed-header":"",style:{"font-size":"16px"},"show-select":!1,hover:i(s).users.length>0},{"no-data":t(()=>[ae]),loading:t(()=>[e(v,{type:"table-row-divider@3"})]),"item.adm":t(({item:d})=>[d.adm?(_(),V(l,{key:0,class:"py-4",color:"var(--primary-color)",style:{"font-weight":"600","font-size":"medium","border-radius":"10px"}},{default:t(()=>[x("Administrador")]),_:1})):(_(),V(l,{key:1,class:"py-4",color:"secondary",style:{"font-weight":"600","font-size":"medium","border-radius":"10px"}},{default:t(()=>[x("Consultor")]),_:1}))]),"item.ativo":t(({item:d})=>[e(F,{class:"mt-1",color:"var(--primary-color)",style:{display:"inline-flex",overflow:"hidden"},modelValue:d.ativo,"onUpdate:modelValue":f=>d.ativo=f,onChange:f=>i(s).atualizarUsuario(i(s).users.filter(a=>a.idFuncionario===d.idFuncionario)[0],null,!1),inset:""},null,8,["modelValue","onUpdate:modelValue","onChange"])]),"item.action":t(({item:d})=>[e(z,{location:"bottom right","close-on-content-click":!1},{activator:t(({props:f})=>[e(k,H({icon:"mdi-dots-vertical"},f,{variant:"text",size:"40"}),null,16)]),default:t(()=>[e(m,{style:{"min-width":"150px"}},{default:t(()=>[e(O,{edit:!0,id:d.idFuncionario},null,8,["id"]),e(u,{onClick:f=>i(s).enviarEmailNewPass({email:d.email,urlBase:`${i(N)}/auth/`,type:"user"})},{append:t(()=>[i(s).loadEnviarEmailNewPass?(_(),V($,{key:0,class:"ml-3",indeterminate:"",size:22,style:{color:"var(--primary-color)"}})):J("",!0)]),default:t(()=>[e(S,{left:"",activator:"parent"},{default:t(()=>[x("Enviar email de redefinição de senha")]),_:1}),x(" Alterar senha ")]),_:2},1032,["onClick"]),e(u,{onClick:f=>i(s).deletarUsuario({idFuncionario:d.idFuncionario})},{default:t(()=>[x("Excluir")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[g("div",te,[!i(s).loadUsers&&i(s).users.length>0&&i(s).users.length>c.value?(_(),V(A,{key:0,rounded:"",style:{"max-width":"700px","margin-inline":"auto"},modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=d=>p.value=d),length:o.value},null,8,["modelValue","length"])):J("",!0)])]),_:1},8,["loading","disabled","modelValue","page","headers","items","items-per-page","hover"])]),_:1})]),_:1})}}},ue=j(ne,[["__scopeId","data-v-1079656f"]]);export{ue as default};
